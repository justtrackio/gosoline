"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4264],{5258(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"reference/package-test","title":"Package test","description":"This package acts as a wrapper over Golang\'s testing module.","source":"@site/docs/reference/package-test.mdx","sourceDirName":"reference","slug":"/reference/package-test","permalink":"/gosoline/reference/package-test","draft":false,"unlisted":false,"editUrl":"https://github.com/justtrackio/gosoline/tree/main/docs/docs/reference/package-test.mdx","tags":[],"version":"current","frontMatter":{"title":"Package test"},"sidebar":"docSidebar","previous":{"title":"Package log","permalink":"/gosoline/reference/package-log"}}');var s=i(4848),r=i(8453);const o={title:"Package test"},c=void 0,a={},l=[{value:"Interfaces",id:"interfaces",level:2},{value:"Suite",id:"suite",level:3},{value:"Interface",id:"interface",level:4},{value:"Functions",id:"functions",level:2},{value:"Run()",id:"run",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Description",id:"description",level:4},{value:"Configuration",id:"configuration",level:2},{value:"Container expiry",id:"container-expiry",level:4},{value:"Image configuration",id:"image-configuration",level:4}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["This package acts as a wrapper over Golang's ",(0,s.jsx)(n.code,{children:"testing"})," module."]}),"\n",(0,s.jsx)(n.h2,{id:"interfaces",children:"Interfaces"}),"\n",(0,s.jsx)(n.h3,{id:"suite",children:(0,s.jsx)(n.a,{href:"https://github.com/justtrackio/gosoline/blob/9b64c30bc4156d16fb1f2d11930f0b686b5d0113/pkg/test/suite/suite.go#L11",children:"Suite"})}),"\n",(0,s.jsx)(n.h4,{id:"interface",children:"Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type TestingSuite interface {\n\tEnv() *env.Environment\n\tSetEnv(environment *env.Environment)\n\tSetT(t *testing.T)\n\tT() *testing.T\n\tSetupSuite() []Option\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"functions",children:"Functions"}),"\n",(0,s.jsx)(n.h3,{id:"run",children:(0,s.jsx)(n.a,{href:"https://github.com/justtrackio/gosoline/blob/9b64c30bc4156d16fb1f2d11930f0b686b5d0113/pkg/test/suite/run.go#L30",children:"Run()"})}),"\n",(0,s.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"t *testing.T"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"suite TestingSuite"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"extraOptions ...Option"})}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"description",children:"Description"}),"\n",(0,s.jsx)(n.p,{children:"This is the starting point for a gosoline integration test. This performs the following steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Uses reflection to find all test cases declared by a given ",(0,s.jsx)(n.code,{children:"TestSuite"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Applies each of the ",(0,s.jsx)(n.code,{children:"extraOptions"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Creates a kernel with whatever modules or APIs were declared in the ",(0,s.jsx)(n.code,{children:"SetupSuite"})," and ",(0,s.jsx)(n.code,{children:"SetupApiDefinitions"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Runs the tests."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Test components are docker container like wiremock or localstack which support you in your integration tests to mock\nyour applications infrastructure."}),"\n",(0,s.jsx)(n.h4,{id:"container-expiry",children:"Container expiry"}),"\n",(0,s.jsxs)(n.p,{children:["All test containers are configured with an automatic expiry time to prevent orphaned containers if tests crash. The default is ",(0,s.jsx)(n.code,{children:"5m"})," (5 minutes). This is configured globally via ",(0,s.jsx)(n.code,{children:"test.container_manager.expire_after"})," and applies to all test containers. You can also use ",(0,s.jsx)(n.code,{children:"suite.WithContainerExpireAfter()"})," to set it programmatically."]}),"\n",(0,s.jsx)(n.h4,{id:"image-configuration",children:"Image configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The used image for a component can be configured on a global and on a per component level. The following configuration\nsnipped shows a config for two wiremock components. ",(0,s.jsx)(n.strong,{children:"mockA"})," gets the image configuration from the global level which is\nconfigured via the key ",(0,s.jsx)(n.code,{children:"test.defaults.images.wiremock"})," and ",(0,s.jsx)(n.strong,{children:"mockB"})," has local configuration. With this, ",(0,s.jsx)(n.strong,{children:"mockA"})," gets\ntag ",(0,s.jsx)(n.code,{children:"3.4.0"})," and ",(0,s.jsx)(n.strong,{children:"mockB"})," gets ",(0,s.jsx)(n.code,{children:"3.3.0"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"test:\n  container_manager:\n    expire_after: 5m  # applies to all containers\n  defaults:\n    images:\n      wiremock:\n        repository: wiremock/wiremock\n        tag: 3.4.0\n  components:\n    wiremock:\n      mockA: {}\n      mockB:\n        image:\n          repository: wiremock/wiremock\n          tag: 3.3.0\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);