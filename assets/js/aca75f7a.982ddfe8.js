"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8082],{7147(e,l,n){n.r(l),n.d(l,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"reference/package-log","title":"Package log","description":"The gosoline logger is based upon a simple interface that uses handlers internally to enable fully customizable log handling.","source":"@site/docs/reference/package-log.mdx","sourceDirName":"reference","slug":"/reference/package-log","permalink":"/gosoline/reference/package-log","draft":false,"unlisted":false,"editUrl":"https://github.com/justtrackio/gosoline/tree/main/docs/docs/reference/package-log.mdx","tags":[],"version":"current","frontMatter":{"title":"Package log"},"sidebar":"docSidebar","previous":{"title":"Package httpserver","permalink":"/gosoline/reference/package-httpserver"},"next":{"title":"Package test","permalink":"/gosoline/reference/package-test"}}');var t=n(4848),s=n(8453);const r={title:"Package log"},o="log package",d={},a=[{value:"Functions",id:"functions",level:2},{value:"NewLogger()",id:"newlogger",level:3},{value:"Usage",id:"usage",level:4},{value:"Description",id:"description",level:4},{value:"NewLoggerWithInterfaces()",id:"newloggerwithinterfaces",level:3},{value:"Usage",id:"usage-1",level:4},{value:"Description",id:"description-1",level:4},{value:"InitContext()",id:"initcontext",level:3},{value:"Usage",id:"usage-2",level:4},{value:"Description",id:"description-2",level:4},{value:"AppendContextFields()",id:"appendcontextfields",level:3},{value:"Usage",id:"usage-3",level:4},{value:"Description",id:"description-3",level:4},{value:"Related methods",id:"related-methods",level:4},{value:"ContextFieldsResolver()",id:"contextfieldsresolver",level:3},{value:"Usage",id:"usage-4",level:4},{value:"Description",id:"description-4",level:4},{value:"Related methods",id:"related-methods-1",level:4},{value:"Methods",id:"methods",level:2},{value:"Debug()",id:"debug",level:3},{value:"Description",id:"description-5",level:4},{value:"Related methods",id:"related-methods-2",level:4},{value:"WithContextFieldsResolver()",id:"withcontextfieldsresolver",level:3},{value:"Usage",id:"usage-5",level:4},{value:"Description",id:"description-6",level:4},{value:"WithFields()",id:"withfields",level:3},{value:"Usage",id:"usage-6",level:4},{value:"Description",id:"description-7",level:4},{value:"WithHandlers()",id:"withhandlers",level:3},{value:"Usage",id:"usage-7",level:4},{value:"Description",id:"description-8",level:4},{value:"Interfaces",id:"interfaces",level:2},{value:"Handler",id:"handler",level:3},{value:"Definition",id:"definition",level:4},{value:"Description",id:"description-9",level:4},{value:"Log configurations",id:"log-configurations",level:2},{value:"Built-in handlers",id:"built-in-handlers",level:2},{value:"iowriter",id:"iowriter",level:3},{value:"Log to STDOUT",id:"log-to-stdout",level:4},{value:"Log to a file",id:"log-to-a-file",level:4},{value:"Metric",id:"metric",level:3},{value:"Sentry",id:"sentry",level:3}];function c(e){const l={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components},{Details:n}=l;return n||function(e,l){throw new Error("Expected "+(l?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.header,{children:(0,t.jsx)(l.h1,{id:"log-package",children:"log package"})}),"\n",(0,t.jsx)(l.p,{children:"The gosoline logger is based upon a simple interface that uses handlers internally to enable fully customizable log handling."}),"\n",(0,t.jsx)(l.h2,{id:"functions",children:"Functions"}),"\n",(0,t.jsx)(l.h3,{id:"newlogger",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/ff4eff871415fdf1b2b0d4ae86f99a48a990778c/pkg/log/logger.go#L91",children:"NewLogger()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:"logger := log.NewLogger()\n"})}),"\n",(0,t.jsx)(l.h4,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(l.p,{children:["Create a logger with no handlers and a real time clock. This provides an extended interface, including the ",(0,t.jsx)(l.code,{children:"Option(opt ...Option) error"})," function to change the behaviour of the logger."]}),"\n",(0,t.jsx)(l.h3,{id:"newloggerwithinterfaces",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/ff4eff871415fdf1b2b0d4ae86f99a48a990778c/pkg/log/logger.go#L95",children:"NewLoggerWithInterfaces()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage-1",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:"logger := log.NewLoggerWithInterfaces(myClock, []log.Handler{handler1, handler2})\n"})}),"\n",(0,t.jsx)(l.h4,{id:"description-1",children:"Description"}),"\n",(0,t.jsxs)(l.p,{children:["Provide a clock and some handlers when you create a new logger. Like ",(0,t.jsx)(l.a,{href:"#newlogger",children:(0,t.jsx)(l.code,{children:"NewLogger()"})}),", this provides an extended interface, including the ",(0,t.jsx)(l.code,{children:"Option(opt ...Option) error"})," function to change the behaviour of the logger."]}),"\n",(0,t.jsx)(l.h3,{id:"initcontext",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/47a5bcfec77e453330c6ac6d5fb72c486f9c7321/pkg/log/context.go#L80",children:"InitContext()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage-2",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:"ctx = log.InitContext(ctx)\n"})}),"\n",(0,t.jsx)(l.h4,{id:"description-2",children:"Description"}),"\n",(0,t.jsx)(l.p,{children:"Return a new context capable of carrying (mutable) local and global logger fields."}),"\n",(0,t.jsx)(l.h3,{id:"appendcontextfields",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/47a5bcfec77e453330c6ac6d5fb72c486f9c7321/pkg/log/context.go#L115C6-L115C25",children:"AppendContextFields()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage-3",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'localCtx := log.AppendContextFields(ctx, map[string]any{\n  "field": "value",\n})\n'})}),"\n",(0,t.jsx)(l.h4,{id:"description-3",children:"Description"}),"\n",(0,t.jsxs)(l.p,{children:["Appends fields to the existing ",(0,t.jsx)(l.strong,{children:"local"})," context fields, creating and returning a new context containing the merged fields."]}),"\n",(0,t.jsx)(l.admonition,{type:"caution",children:(0,t.jsx)(l.p,{children:"Any existing fields with the same key as any new field provided will be overwritten."})}),"\n",(0,t.jsx)(l.h4,{id:"related-methods",children:"Related methods"}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"MutateContextFields()"}),(0,t.jsxs)(l.p,{children:["Mutates ",(0,t.jsx)(l.strong,{children:"local"})," context fields if the context already contains fields which can be mutated. Otherwise, it initializes a new context able to carry fields in the future."]}),(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'localCtx = log.MutateContextFields(localCtx, map[string]any{\n\t"field": "new_value",\n})\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"AppendGlobalContextFields()"}),(0,t.jsxs)(l.p,{children:["Appends fields to the existing ",(0,t.jsx)(l.strong,{children:"global"})," context fields, creating a new context containing the merged fields."]}),(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'localCtx = log.AppendGlobalContextFields(globalCtx, map[string]any{\n\t"field": "new_value",\n})\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"MutateGlobalContextFields()"}),(0,t.jsxs)(l.p,{children:["Mutates ",(0,t.jsx)(l.strong,{children:"global"})," context fields if the context already contains fields which can be mutated. Otherwise, it initializes a new context able to carry fields in the future."]}),(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'localCtx = log.MutateGlobalContextFields(globalCtx, map[string]any{\n\t"field": "new_value",\n})\n'})}),(0,t.jsx)(l.admonition,{type:"caution",children:(0,t.jsx)(l.p,{children:"Global fields override local fields when they have the same name."})})]}),"\n",(0,t.jsx)(l.h3,{id:"contextfieldsresolver",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/47a5bcfec77e453330c6ac6d5fb72c486f9c7321/pkg/log/context.go#L209C6-L209C27",children:"ContextFieldsResolver()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage-4",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'localFields := log.ContextFieldsResolver(ctx)\nprint(localFields["field"])\n'})}),"\n",(0,t.jsx)(l.h4,{id:"description-4",children:"Description"}),"\n",(0,t.jsx)(l.p,{children:"Extracts the local and global fields from a context and returns a map."}),"\n",(0,t.jsx)(l.h4,{id:"related-methods-1",children:"Related methods"}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"GlobalContextFieldsResolver()"}),(0,t.jsx)(l.p,{children:"Extracts the global fields from a context and returns a map."}),(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'localFields := log.GlobalContextFieldsResolver(ctx)\nprint(localFields["field"])\n'})})]}),"\n",(0,t.jsx)(l.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(l.h3,{id:"debug",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/ff4eff871415fdf1b2b0d4ae86f99a48a990778c/pkg/log/logger.go#L119",children:"Debug()"})}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'logger.Debug(ctx, "Message")\n'})}),"\n",(0,t.jsx)(l.h4,{id:"description-5",children:"Description"}),"\n",(0,t.jsx)(l.p,{children:"Logs a message at the Debug log level."}),"\n",(0,t.jsx)(l.h4,{id:"related-methods-2",children:"Related methods"}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Info()"}),(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'logger.Info(ctx, "Message")\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Warn()"}),(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'logger.Warn(ctx, "Message")\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Error()"}),(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'logger.Error(ctx, "Message")\n'})})]}),"\n",(0,t.jsx)(l.h3,{id:"withcontextfieldsresolver",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/ff4eff871415fdf1b2b0d4ae86f99a48a990778c/pkg/log/options.go#L5",children:"WithContextFieldsResolver()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage-5",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:"if err := logger.Option(log.WithContextFieldsResolver(log.ContextFieldsResolver)); err != nil {\n\tpanic(err)\n}\n"})}),"\n",(0,t.jsx)(l.h4,{id:"description-6",children:"Description"}),"\n",(0,t.jsx)(l.p,{children:"Adds a context fields resolver to the logger."}),"\n",(0,t.jsx)(l.h3,{id:"withfields",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/ff4eff871415fdf1b2b0d4ae86f99a48a990778c/pkg/log/options.go#L13",children:"WithFields()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage-6",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'loggerWithFields := logger.WithFields(log.Fields{\n\t"b": true,\n})\n'})}),"\n",(0,t.jsx)(l.h4,{id:"description-7",children:"Description"}),"\n",(0,t.jsx)(l.p,{children:"Adds global fields to the logger, which will be set on every log message."}),"\n",(0,t.jsx)(l.h3,{id:"withhandlers",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/ff4eff871415fdf1b2b0d4ae86f99a48a990778c/pkg/log/options.go#L21",children:"WithHandlers()"})}),"\n",(0,t.jsx)(l.h4,{id:"usage-7",children:"Usage"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:'\tlogHandler := log.NewHandlerIoWriter(cfg.New(), log.PriorityInfo, log.FormatterConsole, "main", "15:04:05.000", os.Stdout)\n\tloggerOptions := []log.Option{\n\t\tlog.WithHandlers(logHandler),\n\t}\n'})}),"\n",(0,t.jsx)(l.h4,{id:"description-8",children:"Description"}),"\n",(0,t.jsx)(l.p,{children:"Adds additional handlers to the logger."}),"\n",(0,t.jsx)(l.h2,{id:"interfaces",children:"Interfaces"}),"\n",(0,t.jsx)(l.h3,{id:"handler",children:(0,t.jsx)(l.a,{href:"https://github.com/justtrackio/gosoline/blob/ff4eff871415fdf1b2b0d4ae86f99a48a990778c/pkg/log/handler.go#L10",children:"Handler"})}),"\n",(0,t.jsx)(l.h4,{id:"definition",children:"Definition"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-go",children:"type Handler interface {\n\tChannelLevel(name string) (level *int, err error)\n\tLevel() int\n\tLog(ctx context.Context, timestamp time.Time, level int, msg string, args []any, err error, data Data) error\n}\n"})}),"\n",(0,t.jsx)(l.h4,{id:"description-9",children:"Description"}),"\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsxs)(l.li,{children:[(0,t.jsx)(l.code,{children:"ChannelLevel(name string) (level *int, err error)"})," and ",(0,t.jsx)(l.code,{children:"Level() int"})," are called on every log action to check if the handler should be applied."]}),"\n",(0,t.jsxs)(l.li,{children:[(0,t.jsx)(l.code,{children:"Log"})," does the actual logging afterwards."]}),"\n"]}),"\n",(0,t.jsx)(l.h2,{id:"log-configurations",children:"Log configurations"}),"\n",(0,t.jsxs)(l.table,{children:[(0,t.jsx)(l.thead,{children:(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.th,{children:"setting"}),(0,t.jsx)(l.th,{children:"description"}),(0,t.jsx)(l.th,{children:"default"})]})}),(0,t.jsxs)(l.tbody,{children:[(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"log.level"}),(0,t.jsx)(l.td,{children:"default level for all handlers without an explicit level value"}),(0,t.jsx)(l.td,{children:"info"})]}),(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"log.handlers"}),(0,t.jsx)(l.td,{children:"a map of handlers that will be called for every log message"}),(0,t.jsx)(l.td,{children:"every logger gets a 'main' handler by default if there is no other handler defined"})]}),(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"log.handlers.X.type"}),(0,t.jsx)(l.td,{children:"defines the type of the handler"}),(0,t.jsx)(l.td,{children:"-"})]})]})]}),"\n",(0,t.jsx)(l.h2,{id:"built-in-handlers",children:"Built-in handlers"}),"\n",(0,t.jsx)(l.p,{children:"Gosoline has a couple of built-in handlers, which are ready to use out of the box:"}),"\n",(0,t.jsx)(l.h3,{id:"iowriter",children:"iowriter"}),"\n",(0,t.jsxs)(l.p,{children:["Multitool, which is able to write logs to everything which implements the ",(0,t.jsx)(l.code,{children:"io.Writer"})," interface. Config options are:"]}),"\n",(0,t.jsxs)(l.table,{children:[(0,t.jsx)(l.thead,{children:(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.th,{children:"Setting"}),(0,t.jsx)(l.th,{children:"Description"}),(0,t.jsx)(l.th,{children:"Default"})]})}),(0,t.jsxs)(l.tbody,{children:[(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"level"}),(0,t.jsx)(l.td,{children:"Levels of this and higher priority will get logged"}),(0,t.jsx)(l.td,{children:"info"})]}),(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"channels"}),(0,t.jsx)(l.td,{children:"Messages logged into these channels will be handled"}),(0,t.jsx)(l.td,{})]}),(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"formatter"}),(0,t.jsx)(l.td,{children:"Which format should be used by this handler"}),(0,t.jsx)(l.td,{children:"console"})]}),(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"timestamp_format"}),(0,t.jsx)(l.td,{children:"A golang time format string to control the format of the timestamp"}),(0,t.jsx)(l.td,{children:"15:04:05.000"})]}),(0,t.jsxs)(l.tr,{children:[(0,t.jsx)(l.td,{children:"writer"}),(0,t.jsx)(l.td,{children:"Which io.writer implementation to use"}),(0,t.jsx)(l.td,{children:"stdout"})]})]})]}),"\n",(0,t.jsx)(l.h4,{id:"log-to-stdout",children:"Log to STDOUT"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-yaml",children:"log:\n  handlers:\n    main:\n      type: iowriter\n      level: info\n      channels: {}\n      formatter: console\n      timestamp_format: 15:04:05.000\n      writer: stdout\n"})}),"\n",(0,t.jsx)(l.h4,{id:"log-to-a-file",children:"Log to a file"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-yaml",children:"log:\n  handlers:\n    main:\n      type: iowriter\n      level: info\n      channels: {}\n      formatter: console\n      timestamp_format: 15:04:05.000\n      writer: file\n      path: logs.log\n"})}),"\n",(0,t.jsx)(l.h3,{id:"metric",children:"Metric"}),"\n",(0,t.jsx)(l.p,{children:"No configuration needed. Writes a metric data point for every warn and error log."}),"\n",(0,t.jsx)(l.h3,{id:"sentry",children:"Sentry"}),"\n",(0,t.jsx)(l.p,{children:"No configuration needed. Publishes every logged error to Sentry."})]})}function h(e={}){const{wrapper:l}={...(0,s.R)(),...e.components};return l?(0,t.jsx)(l,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);